<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salt City Grid</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1 class="glitch">Salt City Grid</h1>
        <p class="flavor-text">"The toxic dust clouds are bad for health, but great for Healthcareâ„¢ shareholders."</p>

        <div class="events-container">
            <h2>AlwaysBeRunning Events</h2>
            <div id="abr-events" class="event-list">Loading...</div>

            <h2>COBRA Tournaments</h2>
            <div id="cobra-tournaments" class="event-list">Loading...</div>
        </div>
    </div>

    <script>
        // Function to load and display events from a JSON file
        async function loadEvents(jsonFile, containerId, formatter) {
            try {
                const response = await fetch(jsonFile);
                if (!response.ok) throw new Error("Failed to load " + jsonFile);
                const events = await response.json();

                const container = document.getElementById(containerId);
                container.innerHTML = ""; // Clear loading text

                if (events.length === 0) {
                    container.innerHTML = "<p>No upcoming events found.</p>";
                    return;
                }

                events.forEach(event => {
                    const eventHTML = formatter(event);
                    container.innerHTML += eventHTML;
                });
            } catch (error) {
                console.error("Error loading events:", error);
                document.getElementById(containerId).innerHTML = "<p>Error loading events.</p>";
            }
        }

        // Formatter for ABR events
        function formatABREvent(event) {
            return `
                <div class="event">
                    <h3><a href="${event.url}" target="_blank">${event.title}</a></h3>
                    <p><strong>Date:</strong> ${event.date.replace(/\./g, '-')}</p>
                    <p><strong>Location:</strong> ${event.location}</p>
                    <p><strong>Organizer:</strong> ${event.creator_name}</p>
                    <p><strong>Players:</strong> ${event.players_count}</p>
                </div>
            `;
        }

        // Formatter for COBRA tournaments
        function formatCobraTournament(event) {
            return `
                <div class="event">
                    <h3><a href="${event.url}" target="_blank">${event.title}</a></h3>
                    <p><strong>Date:</strong> ${event.date}</p>
                    <p><strong>Organizer:</strong> ${event.tournament_organizer}</p>
                    <p><strong>Players:</strong> ${event.player_count}</p>
                </div>
            `;
        }

        // Load events
        loadEvents("abr_data.json", "abr-events", formatABREvent);
        loadEvents("cobra_tournaments.json", "cobra-tournaments", formatCobraTournament);
    </script>
</body>
</html>
